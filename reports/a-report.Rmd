---
title: "Analise da atividade dos parlamentares no Twitter no ano de 2019"
author: "Alice Fernandes Silva, Elton Dantas de Oliveira Mesquita, Igor Matheus Castor Diniz Pinheiro"
theme: sandstone
output:
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
  html_notebook:
    toc: yes
    toc_float: yes
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(gridExtra)
source(here::here("code/lib.R"))
theme_set(theme_bw())
options(scipen = 999)
```

```{r read}
atividade = read_projectdata()
glimpse(atividade)
```

# Desde o uso das novas tecnologias nas eleições americanas de 2008, o Twitter tem se tornado uma plataforma para as atividades políticas, criando um canal para a interação entre políticos e eleitores. A comunicação política com o uso de mídia social é parte das atividades congressistas nos dias atuais. Além disto, o Twitter se constitui como importante meio para o ganho de popularidade com fins eleitorais.

# O cenário político brasileiro não é diferente e, a cada dia, nossos parlamentares estão mais ativos nas redes sociais. Com base nisto, este relatório se propõe a respoder algumas questões de curiosidade à população.

# *Deputados sem perfis ou com número de seguidores não registrados foram desconsiderados.

##Levando em consideração os parlamentares e seus respectivos alcances em redes sociais, Quais são os partidos que possuem o maior poder de influência no twitter?

```{r}
atividade_dep = atividade %>%
                  na.omit(seguidores) %>% 
                  filter(casa == "câmara")
glimpse(atividade_dep)

```

# Como é a relação entre o engajamento de cada parlamentar e o seu número de seguidores?
```{r}
  atividade_dep %>%
    ggplot(aes(x = engaj_total, y = seguidores)) +
    geom_point(stat = "identity", size = 2, aes())

  atividade_dep %>%
    ggplot(aes(x = engaj_total, y = seguidores)) +
    geom_point(stat = "identity", size = 2, aes()) +
    scale_x_log10()
```

# Percebe-se que não há uma linearidade nesta relação. Há sim uma concentração considerável de deputados que possuem pouco engajamento e poucos seguidores, entretanto o aumento de engajamento não implica necessariamente no aumento de seguidores e vice-versa.

```{r}
engaj_mediano_partido = 
  atividade %>%
  na.omit(engaj_mediano) %>%
  group_by(partido) %>%
  filter(partido != 'S/Partido') %>%
  summarise(engaj_med_part = median(engaj_mediano))

engaj_mediano_partido %>%
  group_by(partido)%>%
  ggplot(aes(x= reorder(partido, engaj_med_part), y= engaj_med_part,fill = partido) ) +
  geom_col(show.legend = FALSE)+
  labs(y='engajamento_mediano_do_partido', x= 'partidos')+
  coord_flip()

```

##Os deputados que são filiados ao PSL e PSOL são ativos no twitter assim como o atual presidente da república?


```{r}
camara_psl_psol = atividade %>%
    filter(casa == "câmara") %>%
  filter(partido == "PSL" | partido == "PSOL") %>%
  filter(twitter != "NA")
glimpse(camara_psl_psol)
```
```{r}
grafico1 = camara_psl_psol %>%
  filter(partido=="PSL") %>% 
  ggplot(mapping = aes(x = engaj_total, y = nome_eleitoral)) +
  geom_jitter()

grafico2 = camara_psl_psol %>%
  filter(partido=="PSOL") %>% 
  ggplot(mapping = aes(x = engaj_total, y = nome_eleitoral)) +
  geom_jitter()
  
grid.arrange(grafico1, grafico2, ncol=2)
```






